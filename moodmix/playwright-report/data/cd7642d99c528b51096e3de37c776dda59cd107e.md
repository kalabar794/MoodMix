# Test info

- Name: YouTube Video Visibility Debug >> should debug YouTube video visibility issues
- Location: /Users/jonathonc/Auto1111/claude/MoodMix/moodmix/tests/youtube-visibility-debug.spec.ts:4:7

# Error details

```
Error: page.goto: net::ERR_CONNECTION_REFUSED at http://localhost:3000/
Call log:
  - navigating to "http://localhost:3000/", waiting until "load"

    at /Users/jonathonc/Auto1111/claude/MoodMix/moodmix/tests/youtube-visibility-debug.spec.ts:8:16
```

# Page snapshot

```yaml
- heading "This site canâ€™t be reached" [level=1]
- paragraph:
  - strong: localhost
  - text: refused to connect.
- paragraph: "Try:"
- list:
  - listitem: Checking the connection
  - listitem:
    - link "Checking the proxy and the firewall":
      - /url: "#buttons"
- text: ERR_CONNECTION_REFUSED
- button "Reload"
- button "Details"
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test'
   2 |
   3 | test.describe('YouTube Video Visibility Debug', () => {
   4 |   test('should debug YouTube video visibility issues', async ({ page }) => {
   5 |     console.log('ðŸŽ¬ Starting YouTube visibility debug test...')
   6 |     
   7 |     // Navigate to the app
>  8 |     await page.goto('http://localhost:3000')
     |                ^ Error: page.goto: net::ERR_CONNECTION_REFUSED at http://localhost:3000/
   9 |     
   10 |     // Wait for page to fully load
   11 |     await page.waitForLoadState('networkidle')
   12 |     await page.waitForTimeout(2000)
   13 |     
   14 |     // Take screenshot of initial state
   15 |     await page.screenshot({ 
   16 |       path: 'test-results/youtube-visibility-debug-initial.png',
   17 |       fullPage: true 
   18 |     })
   19 |     
   20 |     // Check if mood wheel is visible
   21 |     const moodWheel = page.locator('[data-testid="mood-wheel"], .mood-wheel, svg circle')
   22 |     console.log('ðŸŽ¯ Looking for mood wheel...')
   23 |     await expect(moodWheel.first()).toBeVisible({ timeout: 10000 })
   24 |     
   25 |     // Click on a mood (try multiple selectors)
   26 |     const moodOptions = [
   27 |       'circle[data-mood]',
   28 |       '[data-mood]', 
   29 |       '.mood-segment',
   30 |       'circle'
   31 |     ]
   32 |     
   33 |     let moodClicked = false
   34 |     for (const selector of moodOptions) {
   35 |       const elements = page.locator(selector)
   36 |       const count = await elements.count()
   37 |       console.log(`ðŸŽ¯ Found ${count} elements with selector: ${selector}`)
   38 |       
   39 |       if (count > 0) {
   40 |         console.log(`ðŸŽ¯ Clicking mood with selector: ${selector}`)
   41 |         await elements.first().click()
   42 |         moodClicked = true
   43 |         break
   44 |       }
   45 |     }
   46 |     
   47 |     if (!moodClicked) {
   48 |       console.log('âš ï¸ Could not find mood to click, checking page content...')
   49 |       const pageContent = await page.content()
   50 |       console.log('Page title:', await page.title())
   51 |       
   52 |       // Look for any clickable elements
   53 |       const clickables = page.locator('button, [role="button"], [onclick], [data-mood]')
   54 |       const clickableCount = await clickables.count()
   55 |       console.log(`Found ${clickableCount} clickable elements`)
   56 |       
   57 |       if (clickableCount > 0) {
   58 |         console.log('ðŸŽ¯ Clicking first available clickable element')
   59 |         await clickables.first().click()
   60 |       }
   61 |     }
   62 |     
   63 |     // Wait for results to load
   64 |     console.log('â³ Waiting for music results...')
   65 |     await page.waitForTimeout(5000)
   66 |     
   67 |     // Take screenshot after mood selection
   68 |     await page.screenshot({ 
   69 |       path: 'test-results/youtube-visibility-debug-after-mood.png',
   70 |       fullPage: true 
   71 |     })
   72 |     
   73 |     // Check for music results
   74 |     const musicResults = page.locator('.track-card, [data-testid="music-results"], .music-card')
   75 |     const resultsCount = await musicResults.count()
   76 |     console.log(`ðŸŽµ Found ${resultsCount} music results`)
   77 |     
   78 |     if (resultsCount > 0) {
   79 |       // Look for YouTube buttons
   80 |       const youtubeButtons = page.locator('button[title*="YouTube"], .youtube-button, button:has(svg)')
   81 |       const youtubeCount = await youtubeButtons.count()
   82 |       console.log(`ðŸŽ¬ Found ${youtubeCount} potential YouTube buttons`)
   83 |       
   84 |       // Check each music card for YouTube functionality
   85 |       for (let i = 0; i < Math.min(resultsCount, 3); i++) {
   86 |         const card = musicResults.nth(i)
   87 |         console.log(`ðŸŽµ Examining music card ${i + 1}...`)
   88 |         
   89 |         // Look for YouTube button in this card
   90 |         const cardYouTubeButton = card.locator('button[title*="YouTube"], button:has(svg[viewBox]):not(:has(path[d*="spotify"]))').first()
   91 |         const hasYouTubeButton = await cardYouTubeButton.count() > 0
   92 |         
   93 |         if (hasYouTubeButton) {
   94 |           console.log(`âœ… Found YouTube button in card ${i + 1}`)
   95 |           
   96 |           // Check if button is visible and enabled
   97 |           const isVisible = await cardYouTubeButton.isVisible()
   98 |           const isEnabled = await cardYouTubeButton.isEnabled()
   99 |           
  100 |           console.log(`YouTube button - Visible: ${isVisible}, Enabled: ${isEnabled}`)
  101 |           
  102 |           if (isVisible && isEnabled) {
  103 |             console.log(`ðŸŽ¬ Clicking YouTube button on card ${i + 1}`)
  104 |             
  105 |             // Click the YouTube button
  106 |             await cardYouTubeButton.click()
  107 |             await page.waitForTimeout(2000)
  108 |             
```