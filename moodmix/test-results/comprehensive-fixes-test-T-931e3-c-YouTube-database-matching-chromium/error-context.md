# Test info

- Name: Test specific YouTube database matching
- Location: /Users/jonathonc/Auto1111/claude/MoodMix/moodmix/tests/comprehensive-fixes-test.spec.ts:84:5

# Error details

```
Error: expect(received).toBeGreaterThan(expected)

Expected: > 2
Received:   2
    at /Users/jonathonc/Auto1111/claude/MoodMix/moodmix/tests/comprehensive-fixes-test.spec.ts:127:24
```

# Page snapshot

```yaml
- main:
  - img
  - heading "MoodMix" [level=1]
  - text: MoodMix
  - paragraph: Current Mood
  - paragraph: euphoric
  - button "Change Mood"
  - button "Auto theme"
  - button "Show keyboard shortcuts"
  - text: Current Mood euphoric Intensity 75% Tracks Found 20
  - heading "Your Perfect Soundtrack" [level=2]
  - paragraph: Blissful melodies that amplify your pure joy and elation
  - text: 20 tracks curated for you 1
  - 'img "Time Out: New Year‚Äôs Eve Party, Background Celebration Songs 2020, Soft Jazz Vintage Mood"'
  - heading "Funny Dance" [level=3]
  - paragraph: Dale Burbeck
  - paragraph: "Time Out: New Year‚Äôs Eve Party, Background Celebration Songs 2020, Soft Jazz Vintage Mood"
  - text: 3:44
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/4rP3zawo5v2JiLjXiVqA9V
    - img
  - text: "2"
  - 'img "Jazz Music for Kids Day Celebration: Fun Play with Family (Spend Positive Time with Your Child)"'
  - heading "Party for Kids (Dance and Fun)" [level=3]
  - paragraph: Smooth Jazz Family Collective
  - paragraph: "Jazz Music for Kids Day Celebration: Fun Play with Family (Spend Positive Time with Your Child)"
  - text: 3:22
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/4KkYz0PEAA2yy77E5AVX16
    - img
  - text: "3"
  - img "LGBT Disco! Pride Month Celebration With Funky Dance Music"
  - heading "Party All Night" [level=3]
  - paragraph: Gay Bar Club, Just Dancing, Summertime Jazz
  - paragraph: LGBT Disco! Pride Month Celebration With Funky Dance Music
  - text: 3:47
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/3FfKfbfcDMEopvaA5tP1EL
    - img
  - text: "4"
  - 'img "Midnight Snowfall Celebration: Music for Welcoming the New Year"'
  - 'heading "Santa‚Äôs Dance Party: Fun Christmas Tunes to Get Everyone Moving" [level=3]'
  - paragraph: Drelliot
  - paragraph: "Midnight Snowfall Celebration: Music for Welcoming the New Year"
  - text: 3:57
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/5nOj9FTz6rVPNspzmthUUH
    - img
  - text: "5"
  - img "Retro Funky Edm Chill Dance Party Music"
  - heading "Centaur Celebration (Funky Chill Dance Beats)" [level=3]
  - paragraph: EDM Machine
  - paragraph: Retro Funky Edm Chill Dance Party Music
  - text: 3:48
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/72EAccSyUhBFJCNMAyfaOs
    - img
  - text: "6"
  - 'img "Wigwam Kids Party: Music Accompaniment for Fun and Games, Birthday Celebration (Children Between 5 to 8 years old), Vol. 1"'
  - heading "Little Shamanic Dance" [level=3]
  - paragraph: Child Care Specialists
  - paragraph: "Wigwam Kids Party: Music Accompaniment for Fun and Games, Birthday Celebration (Children Between 5 to 8 years old), Vol. 1"
  - text: 3:35
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/4HTxGsDQa9cQkD0FYYlev1
    - img
  - text: "7"
  - img "Popular (Music from the HBO Original Series)"
  - heading "Popular (with Playboi Carti & Madonna) - From The Idol Vol. 1 (Music from the HBO Original Series)" [level=3]
  - paragraph: The Weeknd, Playboi Carti, Madonna
  - paragraph: Popular (Music from the HBO Original Series)
  - text: 3:35
  - button "Watch \"The Weeknd - Blinding Lights (Official Video)\" on YouTube":
    - img
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/6WzRpISELf3YglGAh7TXcG
    - img
  - text: "8"
  - img "Dope Don't Sell Itself"
  - heading "Pop Music (feat. Moneybagg Yo & Beatking)" [level=3]
  - paragraph: 2 Chainz, Moneybagg Yo, BeatKing
  - paragraph: Dope Don't Sell Itself
  - text: 2:05
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/6vhdaXwxDmNYM8d4I383XJ
    - img
  - text: "9"
  - img "Pop Music"
  - heading "Pop Music (feat. Moneybagg Yo & Beatking)" [level=3]
  - paragraph: 2 Chainz, Moneybagg Yo, BeatKing
  - paragraph: Pop Music
  - text: 2:05
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/7562OP1Zx84xqrO5ECYour
    - img
  - text: "10"
  - img "POP MUSIC"
  - heading "SIREN" [level=3]
  - paragraph: Lilyisthatyou
  - paragraph: POP MUSIC
  - text: 2:16
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/1baqAtYnkpNzHAYwqibv0x
    - img
  - text: "11"
  - img "POP MUSIC"
  - heading "RELAX AFTER WORK WITH A DRINK" [level=3]
  - paragraph: Lilyisthatyou
  - paragraph: POP MUSIC
  - text: 1:57
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/1zoJ8Ixu6w7uWdEFToXr6c
    - img
  - text: "12"
  - img "Haha"
  - heading "Pop Music" [level=3]
  - paragraph: Lilac Boy
  - paragraph: Haha
  - text: 2:27
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/64mWHo1y0K4LL2LJJvVPSI
    - img
  - text: "13"
  - img "POP MUSIC"
  - heading "DANCE" [level=3]
  - paragraph: Lilyisthatyou
  - paragraph: POP MUSIC
  - text: 3:14
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/06B93ufTCpb6VWEiqgcVne
    - img
  - text: "14"
  - img "POP MUSIC"
  - heading "GRINDING MY TEETH" [level=3]
  - paragraph: Lilyisthatyou
  - paragraph: POP MUSIC
  - text: 2:17
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/6amkSgnq8S1p7yruuPuADi
    - img
  - text: "15"
  - img "You're Just Like Pop Music"
  - heading "You're Just Like Pop Music" [level=3]
  - paragraph: YonKaGor
  - paragraph: You're Just Like Pop Music
  - text: 3:57
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/0UYnMDFZuXUpsiWGMq1EVk
    - img
  - text: "16"
  - img "POP MUSIC"
  - heading "SUPERSTAR" [level=3]
  - paragraph: Lilyisthatyou
  - paragraph: POP MUSIC
  - text: 2:52
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/5kfQF2FdBSlUrgik8cLYGR
    - img
  - text: "17"
  - img "Popular (Music from the HBO Original Series)"
  - heading "Popular (with Playboi Carti & Madonna) - From The Idol Vol. 1 (Music from the HBO Original Series)" [level=3]
  - paragraph: The Weeknd, Playboi Carti, Madonna
  - paragraph: Popular (Music from the HBO Original Series)
  - text: 3:35
  - button "Watch \"The Weeknd - Blinding Lights (Official Video)\" on YouTube":
    - img
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/67gUqq3wVAztSquOpNZ4Xs
    - img
  - text: "18"
  - img "LEAVE AND FORGET"
  - heading "pop music" [level=3]
  - paragraph: Voda Fuji
  - paragraph: LEAVE AND FORGET
  - text: 1:37
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/2Y6NdnvIVDayrxcNJMmkOR
    - img
  - text: "19"
  - img "Baby Sleep Music"
  - heading "Pop Goes the Weasel" [level=3]
  - paragraph: Lullaby Time
  - paragraph: Baby Sleep Music
  - text: 2:06
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/3kJtQ79tvaCFkCiXtpPfBw
    - img
  - text: "20"
  - img "pop music just hits"
  - heading "Lose Control" [level=3]
  - paragraph: Teddy Swims
  - paragraph: pop music just hits
  - text: 3:30
  - button "Listen on Spotify":
    - img
  - link:
    - /url: https://open.spotify.com/track/00ahQEcgGCvXEujKtLUcZJ
    - img
  - img
  - text: Powered by Spotify
  - paragraph: Powered by Spotify ‚Ä¢ Made for music lovers
- alert
```

# Test source

```ts
   27 |   console.log(`   Total tracks: ${totalTracks}`)
   28 |   console.log(`   YouTube buttons: ${youtubeCount}`)
   29 |   console.log(`   Spotify buttons: ${spotifyCount}`)
   30 |   console.log(`   YouTube coverage: ${((youtubeCount / totalTracks) * 100).toFixed(1)}%`)
   31 |   
   32 |   // Check for duplicate tracks by collecting track names and artists
   33 |   const trackInfo = []
   34 |   for (let i = 0; i < totalTracks; i++) {
   35 |     const trackCard = trackCards.nth(i)
   36 |     
   37 |     // Get track name and artist
   38 |     const trackNameElement = trackCard.locator('h3').first()
   39 |     const artistElement = trackCard.locator('p').first()
   40 |     
   41 |     const trackName = await trackNameElement.textContent()
   42 |     const artistName = await artistElement.textContent()
   43 |     
   44 |     if (trackName && artistName) {
   45 |       const trackSignature = `${trackName.trim()} - ${artistName.trim()}`
   46 |       trackInfo.push(trackSignature)
   47 |       console.log(`   Track ${i + 1}: ${trackSignature}`)
   48 |     }
   49 |   }
   50 |   
   51 |   // Check for duplicates
   52 |   const uniqueTracks = new Set(trackInfo)
   53 |   const duplicateCount = trackInfo.length - uniqueTracks.size
   54 |   
   55 |   console.log(`üîç Duplicate Analysis:`)
   56 |   console.log(`   Total tracks: ${trackInfo.length}`)
   57 |   console.log(`   Unique tracks: ${uniqueTracks.size}`)
   58 |   console.log(`   Duplicates found: ${duplicateCount}`)
   59 |   
   60 |   if (duplicateCount > 0) {
   61 |     console.log(`‚ùå DUPLICATES DETECTED:`)
   62 |     const seen = new Set()
   63 |     for (const track of trackInfo) {
   64 |       if (seen.has(track)) {
   65 |         console.log(`   ‚Ä¢ DUPLICATE: ${track}`)
   66 |       } else {
   67 |         seen.add(track)
   68 |       }
   69 |     }
   70 |   }
   71 |   
   72 |   // Take screenshot for documentation
   73 |   await page.screenshot({ path: 'test-results/comprehensive-fixes-verification.png', fullPage: true })
   74 |   
   75 |   // Assertions
   76 |   expect(totalTracks).toBeGreaterThan(15) // Should have plenty of tracks
   77 |   expect(youtubeCount).toBeGreaterThan(5) // Should have significantly more YouTube coverage now
   78 |   expect(duplicateCount).toBe(0) // Should have no duplicates
   79 |   expect(youtubeCount / totalTracks).toBeGreaterThan(0.3) // At least 30% YouTube coverage
   80 |   
   81 |   console.log('‚úÖ Comprehensive fixes verification complete')
   82 | })
   83 |
   84 | test('Test specific YouTube database matching', async ({ page }) => {
   85 |   console.log('üé¨ Testing YouTube database matching improvements')
   86 |   
   87 |   // Enable debug mode to get consistent test data
   88 |   await page.goto('https://mood-mix-theta.vercel.app/?debug=true')
   89 |   await page.waitForLoadState('networkidle')
   90 |   
   91 |   // Click Euphoric mood
   92 |   const euphoricMood = page.locator('button:has-text("Euphoric")').first()
   93 |   await euphoricMood.click()
   94 |   console.log('‚úÖ Clicked Euphoric mood')
   95 |   
   96 |   // Wait for tracks to load
   97 |   await page.waitForTimeout(8000)
   98 |   
   99 |   // Check console logs for YouTube matching info
  100 |   const consoleLogs = []
  101 |   page.on('console', msg => {
  102 |     if (msg.text().includes('üîç') || msg.text().includes('‚úÖ') || msg.text().includes('‚ö†Ô∏è')) {
  103 |       consoleLogs.push(msg.text())
  104 |     }
  105 |   })
  106 |   
  107 |   // Force a reload to capture console logs
  108 |   await page.reload()
  109 |   await page.waitForTimeout(3000)
  110 |   const euphoricMoodReload = page.locator('button:has-text("Euphoric")').first()
  111 |   await euphoricMoodReload.click()
  112 |   await page.waitForTimeout(8000)
  113 |   
  114 |   // Analyze YouTube buttons again
  115 |   const youtubeButtons = page.locator('button.bg-red-600')
  116 |   const youtubeCount = await youtubeButtons.count()
  117 |   
  118 |   console.log(`üé¨ YouTube Matching Results:`)
  119 |   console.log(`   YouTube buttons found: ${youtubeCount}`)
  120 |   
  121 |   // Print some console logs for debugging
  122 |   console.log(`üìù Console logs (first 10):`)
  123 |   for (let i = 0; i < Math.min(10, consoleLogs.length); i++) {
  124 |     console.log(`   ${consoleLogs[i]}`)
  125 |   }
  126 |   
> 127 |   expect(youtubeCount).toBeGreaterThan(2) // Should have improved matching
      |                        ^ Error: expect(received).toBeGreaterThan(expected)
  128 | })
```